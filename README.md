# MRTFTP
##### TCP/FTP библиотека для передачи файлов и команд
Не лучшее решение, но работает...

## Features
- FTP сервер
- FTP клиент
- Адаптировано для работы в Unity
- Возможность подключения к серверу со сторонних клиентов (например FileZilla)
- Одновременное подключение нескольких клиентов
- Обмен текстовыми сообщениями между клиентом и сервером
- Работа в отдельных потоках

## Getting started
1.  Подключить библиотеку [MRTFTP.dll](build/x86/MRTFTP_dll.dll)
2.  Настройка логирования (необязательно)
```csharp
        FTP.verboseDebugging = true; // логировать ошибки и сообщения
	    FTP.logToConsole = true; // писать сообщения дебага в окно консоли (только для ConsoleApplication)
```
3.  Запуск 
```csharp
        FTP.StartAsServer(21); // запускает сервер на указанном порте
        FTP.StartAsClient("127.0.0.1", 21); // запускает клиент, подключается к указанному адресу и порту
```
4.  События
```csharp
        // события сервера
		FTP.OnClientConnected += (id) => { }; // подключился клиент с id (теперь можно отправлять ему команды)
		FTP.OnClientDisconnected += (id) => { }; // отключился клиент с id

		// события клиента
		FTP.OnServerConnected += () => { }; // установлено соединение с сервером (теперь можно отправлять ему команды и файлы)
		FTP.OnServerDisonnected += () => { }; // разорвано соединение с сервером

		// общие события
		FTP.OnError += (message) => { }; // ошибка на подключенном клиенте/сервере
		FTP.OnSpecialCommand += (id, message) => { }; // пришла команда с подключенного клиента/сервера. У сервера id = -1
```
5.  Отправка команд (**только после события подключения**)
```csharp
        // пример отправки команды с клиента на сервер
	    await FTP.SendCommand("Test nonFTP command from client"); // не будет интерпретироваться как FTP команда
	    string responce = await FTP.SendCommand("CWD TestFolder", true); // интерпретируется как FTP команда
	
	    // пример отправки команды с сервера на клиент
	    await FTP.SendCommand("Test nonFTP command from server", false, 0); // сервер может отправлять только не FTP команды
```
6. Правильное выключение. Закрывает соединения, останавливает потоки и подметает за собой
```csharp
    FTP.Stop(); // один метод для клиента и сервера
```
7.  **Готово! Всё работает!**   ~~(но это не точно)~~.